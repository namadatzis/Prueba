{"ast":null,"code":"'use strict';\n\n/**\n * Module dependencies.\n */\nconst co = require('co');\nconst compose = require('koa-compose');\n\n/**\n * Expose `convert()`.\n */\n\nmodule.exports = convert;\n\n/**\n * Convert Koa legacy generator-based middleware\n * to modern promise-based middleware.\n *\n *\n * @api public\n * */\n\nfunction convert(mw) {\n  if (typeof mw !== 'function') {\n    throw new TypeError('middleware must be a function');\n  }\n\n  // assume it's Promise-based middleware\n  if (mw.constructor.name !== 'GeneratorFunction' && mw.constructor.name !== 'AsyncGeneratorFunction') {\n    return mw;\n  }\n  const converted = function (ctx, next) {\n    return co.call(ctx, mw.call(ctx, function* (next) {\n      return yield next();\n    }(next)));\n  };\n  converted._name = mw._name || mw.name;\n  return converted;\n}\n\n/**\n * Convert and compose multiple middleware\n * (could mix legacy and modern ones)\n * and return modern promise middleware.\n *\n *\n * @api public\n * */\n\n// convert.compose(mw, mw, mw)\n// convert.compose([mw, mw, mw])\nconvert.compose = function (arr) {\n  if (!Array.isArray(arr)) {\n    arr = Array.from(arguments);\n  }\n  return compose(arr.map(convert));\n};\n\n/**\n * Convert Koa modern promise-based middleware\n * to legacy generator-based middleware.\n *\n *\n * @api public\n * */\n\nconvert.back = function (mw) {\n  if (typeof mw !== 'function') {\n    throw new TypeError('middleware must be a function');\n  }\n\n  // assume it's generator middleware\n  if (mw.constructor.name === 'GeneratorFunction' || mw.constructor.name === 'AsyncGeneratorFunction') {\n    return mw;\n  }\n  const converted = function* (next) {\n    const ctx = this;\n    let called = false;\n    yield mw(ctx, function () {\n      if (called) {\n        // guard against multiple next() calls\n        // https://github.com/koajs/compose/blob/4e3e96baf58b817d71bd44a8c0d78bb42623aa95/index.js#L36\n        throw new Error('next() called multiple times');\n      }\n      called = true;\n      return co.call(ctx, next);\n    });\n  };\n  converted._name = mw._name || mw.name;\n  return converted;\n};","map":{"version":3,"names":["co","require","compose","module","exports","convert","mw","TypeError","constructor","name","converted","ctx","next","call","_name","arr","Array","isArray","from","arguments","map","back","called","Error"],"sources":["/Users/namadatzis/Documents/Proyecto Web/nomad/Nomad/node_modules/koa-convert/index.js"],"sourcesContent":["'use strict'\n\n/**\n * Module dependencies.\n */\n\nconst co = require('co')\nconst compose = require('koa-compose')\n\n/**\n * Expose `convert()`.\n */\n\nmodule.exports = convert\n\n/**\n * Convert Koa legacy generator-based middleware\n * to modern promise-based middleware.\n *\n *\n * @api public\n * */\n\nfunction convert (mw) {\n  if (typeof mw !== 'function') {\n    throw new TypeError('middleware must be a function')\n  }\n\n  // assume it's Promise-based middleware\n  if (\n    mw.constructor.name !== 'GeneratorFunction' &&\n    mw.constructor.name !== 'AsyncGeneratorFunction'\n  ) {\n    return mw\n  }\n\n  const converted = function (ctx, next) {\n    return co.call(\n      ctx,\n      mw.call(\n        ctx,\n        (function * (next) { return yield next() })(next)\n      ))\n  }\n\n  converted._name = mw._name || mw.name\n  return converted\n}\n\n/**\n * Convert and compose multiple middleware\n * (could mix legacy and modern ones)\n * and return modern promise middleware.\n *\n *\n * @api public\n * */\n\n// convert.compose(mw, mw, mw)\n// convert.compose([mw, mw, mw])\nconvert.compose = function (arr) {\n  if (!Array.isArray(arr)) {\n    arr = Array.from(arguments)\n  }\n\n  return compose(arr.map(convert))\n}\n\n/**\n * Convert Koa modern promise-based middleware\n * to legacy generator-based middleware.\n *\n *\n * @api public\n * */\n\nconvert.back = function (mw) {\n  if (typeof mw !== 'function') {\n    throw new TypeError('middleware must be a function')\n  }\n\n  // assume it's generator middleware\n  if (mw.constructor.name === 'GeneratorFunction' || mw.constructor.name === 'AsyncGeneratorFunction') {\n    return mw\n  }\n\n  const converted = function * (next) {\n    const ctx = this\n    let called = false\n\n    yield mw(ctx, function () {\n      if (called) {\n        // guard against multiple next() calls\n        // https://github.com/koajs/compose/blob/4e3e96baf58b817d71bd44a8c0d78bb42623aa95/index.js#L36\n        throw new Error('next() called multiple times')\n      }\n\n      called = true\n      return co.call(ctx, next)\n    })\n  }\n\n  converted._name = mw._name || mw.name\n  return converted\n}\n"],"mappings":"AAAA,YAAY;;AAEZ;AACA;AACA;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAAC,IAAI,CAAC;AACxB,MAAMC,OAAO,GAAGD,OAAO,CAAC,aAAa,CAAC;;AAEtC;AACA;AACA;;AAEAE,MAAM,CAACC,OAAO,GAAGC,OAAO;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,OAAO,CAAEC,EAAE,EAAE;EACpB,IAAI,OAAOA,EAAE,KAAK,UAAU,EAAE;IAC5B,MAAM,IAAIC,SAAS,CAAC,+BAA+B,CAAC;EACtD;;EAEA;EACA,IACED,EAAE,CAACE,WAAW,CAACC,IAAI,KAAK,mBAAmB,IAC3CH,EAAE,CAACE,WAAW,CAACC,IAAI,KAAK,wBAAwB,EAChD;IACA,OAAOH,EAAE;EACX;EAEA,MAAMI,SAAS,GAAG,UAAUC,GAAG,EAAEC,IAAI,EAAE;IACrC,OAAOZ,EAAE,CAACa,IAAI,CACZF,GAAG,EACHL,EAAE,CAACO,IAAI,CACLF,GAAG,EACF,WAAYC,IAAI,EAAE;MAAE,OAAO,MAAMA,IAAI,EAAE;IAAC,CAAC,CAAEA,IAAI,CAAC,CAClD,CAAC;EACN,CAAC;EAEDF,SAAS,CAACI,KAAK,GAAGR,EAAE,CAACQ,KAAK,IAAIR,EAAE,CAACG,IAAI;EACrC,OAAOC,SAAS;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACAL,OAAO,CAACH,OAAO,GAAG,UAAUa,GAAG,EAAE;EAC/B,IAAI,CAACC,KAAK,CAACC,OAAO,CAACF,GAAG,CAAC,EAAE;IACvBA,GAAG,GAAGC,KAAK,CAACE,IAAI,CAACC,SAAS,CAAC;EAC7B;EAEA,OAAOjB,OAAO,CAACa,GAAG,CAACK,GAAG,CAACf,OAAO,CAAC,CAAC;AAClC,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,OAAO,CAACgB,IAAI,GAAG,UAAUf,EAAE,EAAE;EAC3B,IAAI,OAAOA,EAAE,KAAK,UAAU,EAAE;IAC5B,MAAM,IAAIC,SAAS,CAAC,+BAA+B,CAAC;EACtD;;EAEA;EACA,IAAID,EAAE,CAACE,WAAW,CAACC,IAAI,KAAK,mBAAmB,IAAIH,EAAE,CAACE,WAAW,CAACC,IAAI,KAAK,wBAAwB,EAAE;IACnG,OAAOH,EAAE;EACX;EAEA,MAAMI,SAAS,GAAG,WAAYE,IAAI,EAAE;IAClC,MAAMD,GAAG,GAAG,IAAI;IAChB,IAAIW,MAAM,GAAG,KAAK;IAElB,MAAMhB,EAAE,CAACK,GAAG,EAAE,YAAY;MACxB,IAAIW,MAAM,EAAE;QACV;QACA;QACA,MAAM,IAAIC,KAAK,CAAC,8BAA8B,CAAC;MACjD;MAEAD,MAAM,GAAG,IAAI;MACb,OAAOtB,EAAE,CAACa,IAAI,CAACF,GAAG,EAAEC,IAAI,CAAC;IAC3B,CAAC,CAAC;EACJ,CAAC;EAEDF,SAAS,CAACI,KAAK,GAAGR,EAAE,CAACQ,KAAK,IAAIR,EAAE,CAACG,IAAI;EACrC,OAAOC,SAAS;AAClB,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}