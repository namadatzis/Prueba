{"ast":null,"code":"/*!\n * keygrip\n * Copyright(c) 2011-2014 Jed Schmidt\n * MIT Licensed\n */\n\n'use strict';\n\nvar compare = require('tsscmp');\nvar crypto = require(\"crypto\");\nfunction Keygrip(keys, algorithm, encoding) {\n  if (!algorithm) algorithm = \"sha1\";\n  if (!encoding) encoding = \"base64\";\n  if (!(this instanceof Keygrip)) return new Keygrip(keys, algorithm, encoding);\n  if (!keys || !(0 in keys)) {\n    throw new Error(\"Keys must be provided.\");\n  }\n  function sign(data, key) {\n    return crypto.createHmac(algorithm, key).update(data).digest(encoding).replace(/\\/|\\+|=/g, function (x) {\n      return {\n        \"/\": \"_\",\n        \"+\": \"-\",\n        \"=\": \"\"\n      }[x];\n    });\n  }\n  this.sign = function (data) {\n    return sign(data, keys[0]);\n  };\n  this.verify = function (data, digest) {\n    return this.index(data, digest) > -1;\n  };\n  this.index = function (data, digest) {\n    for (var i = 0, l = keys.length; i < l; i++) {\n      if (compare(digest, sign(data, keys[i]))) {\n        return i;\n      }\n    }\n    return -1;\n  };\n}\nKeygrip.sign = Keygrip.verify = Keygrip.index = function () {\n  throw new Error(\"Usage: require('keygrip')(<array-of-keys>)\");\n};\nmodule.exports = Keygrip;","map":{"version":3,"names":["compare","require","crypto","Keygrip","keys","algorithm","encoding","Error","sign","data","key","createHmac","update","digest","replace","x","verify","index","i","l","length","module","exports"],"sources":["/Users/namadatzis/Documents/Proyecto Web/nomad/Nomad/node_modules/keygrip/index.js"],"sourcesContent":["/*!\n * keygrip\n * Copyright(c) 2011-2014 Jed Schmidt\n * MIT Licensed\n */\n\n'use strict'\n\nvar compare = require('tsscmp')\nvar crypto = require(\"crypto\")\n  \nfunction Keygrip(keys, algorithm, encoding) {\n  if (!algorithm) algorithm = \"sha1\";\n  if (!encoding) encoding = \"base64\";\n  if (!(this instanceof Keygrip)) return new Keygrip(keys, algorithm, encoding)\n\n  if (!keys || !(0 in keys)) {\n    throw new Error(\"Keys must be provided.\")\n  }\n\n  function sign(data, key) {\n    return crypto\n      .createHmac(algorithm, key)\n      .update(data).digest(encoding)\n      .replace(/\\/|\\+|=/g, function(x) {\n        return ({ \"/\": \"_\", \"+\": \"-\", \"=\": \"\" })[x]\n      })\n  }\n\n  this.sign = function(data){ return sign(data, keys[0]) }\n\n  this.verify = function(data, digest) {\n    return this.index(data, digest) > -1\n  }\n\n  this.index = function(data, digest) {\n    for (var i = 0, l = keys.length; i < l; i++) {\n      if (compare(digest, sign(data, keys[i]))) {\n        return i\n      }\n    }\n\n    return -1\n  }\n}\n\nKeygrip.sign = Keygrip.verify = Keygrip.index = function() {\n  throw new Error(\"Usage: require('keygrip')(<array-of-keys>)\")\n}\n\nmodule.exports = Keygrip\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,YAAY;;AAEZ,IAAIA,OAAO,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAC/B,IAAIC,MAAM,GAAGD,OAAO,CAAC,QAAQ,CAAC;AAE9B,SAASE,OAAO,CAACC,IAAI,EAAEC,SAAS,EAAEC,QAAQ,EAAE;EAC1C,IAAI,CAACD,SAAS,EAAEA,SAAS,GAAG,MAAM;EAClC,IAAI,CAACC,QAAQ,EAAEA,QAAQ,GAAG,QAAQ;EAClC,IAAI,EAAE,IAAI,YAAYH,OAAO,CAAC,EAAE,OAAO,IAAIA,OAAO,CAACC,IAAI,EAAEC,SAAS,EAAEC,QAAQ,CAAC;EAE7E,IAAI,CAACF,IAAI,IAAI,EAAE,CAAC,IAAIA,IAAI,CAAC,EAAE;IACzB,MAAM,IAAIG,KAAK,CAAC,wBAAwB,CAAC;EAC3C;EAEA,SAASC,IAAI,CAACC,IAAI,EAAEC,GAAG,EAAE;IACvB,OAAOR,MAAM,CACVS,UAAU,CAACN,SAAS,EAAEK,GAAG,CAAC,CAC1BE,MAAM,CAACH,IAAI,CAAC,CAACI,MAAM,CAACP,QAAQ,CAAC,CAC7BQ,OAAO,CAAC,UAAU,EAAE,UAASC,CAAC,EAAE;MAC/B,OAAQ;QAAE,GAAG,EAAE,GAAG;QAAE,GAAG,EAAE,GAAG;QAAE,GAAG,EAAE;MAAG,CAAC,CAAEA,CAAC,CAAC;IAC7C,CAAC,CAAC;EACN;EAEA,IAAI,CAACP,IAAI,GAAG,UAASC,IAAI,EAAC;IAAE,OAAOD,IAAI,CAACC,IAAI,EAAEL,IAAI,CAAC,CAAC,CAAC,CAAC;EAAC,CAAC;EAExD,IAAI,CAACY,MAAM,GAAG,UAASP,IAAI,EAAEI,MAAM,EAAE;IACnC,OAAO,IAAI,CAACI,KAAK,CAACR,IAAI,EAAEI,MAAM,CAAC,GAAG,CAAC,CAAC;EACtC,CAAC;EAED,IAAI,CAACI,KAAK,GAAG,UAASR,IAAI,EAAEI,MAAM,EAAE;IAClC,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEC,CAAC,GAAGf,IAAI,CAACgB,MAAM,EAAEF,CAAC,GAAGC,CAAC,EAAED,CAAC,EAAE,EAAE;MAC3C,IAAIlB,OAAO,CAACa,MAAM,EAAEL,IAAI,CAACC,IAAI,EAAEL,IAAI,CAACc,CAAC,CAAC,CAAC,CAAC,EAAE;QACxC,OAAOA,CAAC;MACV;IACF;IAEA,OAAO,CAAC,CAAC;EACX,CAAC;AACH;AAEAf,OAAO,CAACK,IAAI,GAAGL,OAAO,CAACa,MAAM,GAAGb,OAAO,CAACc,KAAK,GAAG,YAAW;EACzD,MAAM,IAAIV,KAAK,CAAC,4CAA4C,CAAC;AAC/D,CAAC;AAEDc,MAAM,CAACC,OAAO,GAAGnB,OAAO"},"metadata":{},"sourceType":"script","externalDependencies":[]}